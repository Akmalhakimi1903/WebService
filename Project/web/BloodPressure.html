<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blood Pressure Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }
    input[type="number"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      margin-top: 20px;
      background-color: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 16px;
    }
    button:hover {
      background-color: #005f99;
    }
    .result {
      margin-top: 30px;
      padding: 15px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
    }
    .result p {
      margin: 8px 0;
    }
    .explanation-box {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background: #fff6e0;
      border-radius: 6px;
    }
    code {
      background: #eef;
      padding: 2px 4px;
      border-radius: 4px;
      font-family: monospace;
    }
    .danger {
      color: #d93025;
      font-weight: bold;
    }
    .warning {
      color: #e37400;
      font-weight: bold;
    }
    .normal {
      color: #188038;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>ðŸ©º Blood Pressure Calculator</h1>

  <div class="explanation">
    <h2>What is Systolic and Diastolic?</h2>
    <p><strong>Systolic:</strong> The top number â€” it measures the pressure in your arteries when your heart beats (contracts).</p>
    <p><strong>Diastolic:</strong> The bottom number â€” it measures the pressure in your arteries when your heart rests between beats.</p>
    <p>Example: If your blood pressure reading is <strong>120/80 mmHg</strong>, 120 is the systolic and 80 is the diastolic.</p>
  </div>

  <form id="bpForm">
    <label for="systolic">Systolic (mmHg):</label>
    <input type="number" id="systolic" name="systolic" min="0" required />

    <label for="diastolic">Diastolic (mmHg):</label>
    <input type="number" id="diastolic" name="diastolic" min="0" required />

    <button type="submit">Calculate Blood Pressure</button>
  </form>

  <div class="result" id="result" style="display:none;">
    <h2>Blood Pressure Result</h2>

    <p><strong>Step 1 - User Info:</strong></p>
    <p><strong>Name:</strong> <span id="resName"></span></p>
    <p><strong>Age:</strong> <span id="resAge"></span></p>
    <p><strong>Gender:</strong> <span id="resGender"></span></p>
    <p><strong>Weight (kg):</strong> <span id="resWeight"></span></p>
    <p><strong>Height (cm):</strong> <span id="resHeight"></span></p>

    <p><strong>Step 2 - Input Blood Pressure Values:</strong></p>
    <p><strong>Systolic:</strong> <span id="resSystolic"></span> mmHg</p>
    <p><strong>Diastolic:</strong> <span id="resDiastolic"></span> mmHg</p>

    <p><strong>Step 3 - Score Calculation:</strong></p>
    <p><strong>Formula Used:</strong> <code>Score = (0.6 Ã— Systolic) + (0.4 Ã— Diastolic)</code></p>
    <p><strong>Calculation:</strong> <code id="resCalculation"></code></p>
    <p><strong>Score:</strong> <span id="resScore"></span></p>

    <p><strong>Step 4 - Classification:</strong></p>
    <p><strong>Classification:</strong> <span id="resClassification"></span></p>

    <div class="explanation-box">
      <p><strong>Explanation:</strong> <span id="resExplanation"></span></p>
    </div>
  </div>

  <button id="backButton" type="button">Back to Calculator</button>

  <script>
    const params = new URLSearchParams(window.location.search);
    const userData = {
      name: params.get("name") || "Unknown",
      age: parseInt(params.get("age")) || 0,
      gender: params.get("gender") || "-",
      weight: parseFloat(params.get("weight")) || 0,
      height: parseFloat(params.get("height")) || 0,
      ic: params.get("ic") || ""
    };

    function classifyBloodPressure(systolic, diastolic) {
      const score = 0.6 * systolic + 0.4 * diastolic;
      if (score < 72) {
        return "Low Blood Pressure (Hypotension)";
      } else if (score < 104) {
        return "Normal Blood Pressure";
      } else if (score < 110) {
        return "Elevated Blood Pressure";
      } else if (score < 122) {
        return "Hypertension Stage 1";
      } else if (score <= 156) {
        return "Hypertension Stage 2";
      } else {
        return "Hypertensive Crisis (Seek Emergency Care)";
      }
    }

    function getExplanation(classification) {
      const explanations = {
        "Low Blood Pressure (Hypotension)": "Your blood pressure is lower than normal. Although it may not always cause problems, very low pressure might lead to dizziness or fainting. Consult your doctor if you experience symptoms.",
        "Normal Blood Pressure": "Your blood pressure is in the healthy range. Keep up your healthy lifestyle to maintain it!",
        "Elevated Blood Pressure": "Your blood pressure is slightly above normal. Lifestyle changes such as better diet and more exercise may help to prevent hypertension.",
        "Hypertension Stage 1": "You have mild high blood pressure. Monitor your lifestyle and consult a healthcare professional for advice.",
        "Hypertension Stage 2": "You have moderately high blood pressure. Medical attention and possible medication may be necessary to control your pressure.",
        "Hypertensive Crisis (Seek Emergency Care)": "Your blood pressure is dangerously high. You should seek immediate medical attention."
      };
      return explanations[classification] || "";
    }

    document.getElementById("bpForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const systolic = parseInt(document.getElementById("systolic").value);
      const diastolic = parseInt(document.getElementById("diastolic").value);

      if (isNaN(systolic) || isNaN(diastolic)) {
        alert("Please enter valid blood pressure values.");
        return;
      }

      const score = 0.6 * systolic + 0.4 * diastolic;
      const classification = classifyBloodPressure(systolic, diastolic);
      const explanation = getExplanation(classification);

      document.getElementById("resName").textContent = userData.name;
      document.getElementById("resAge").textContent = userData.age;
      document.getElementById("resGender").textContent = userData.gender;
      document.getElementById("resWeight").textContent = userData.weight.toFixed(1);
      document.getElementById("resHeight").textContent = userData.height.toFixed(1);
      document.getElementById("resSystolic").textContent = systolic;
      document.getElementById("resDiastolic").textContent = diastolic;
      document.getElementById("resScore").textContent = score.toFixed(2);
      document.getElementById("resCalculation").textContent = `0.6 Ã— ${systolic} + 0.4 Ã— ${diastolic} = ${score.toFixed(2)}`;

      const classificationElement = document.getElementById("resClassification");
      classificationElement.textContent = classification;
      classificationElement.className = ""; // Reset classes
      if (classification.includes("Low") || classification.includes("Crisis")) {
        classificationElement.classList.add("danger");
      } else if (classification.includes("Elevated") || classification.includes("Stage")) {
        classificationElement.classList.add("warning");
      } else if (classification.includes("Normal")) {
        classificationElement.classList.add("normal");
      }

      document.getElementById("resExplanation").textContent = explanation;
      document.getElementById("result").style.display = "block";
    });

    document.getElementById("backButton").addEventListener("click", function () {
      const query = new URLSearchParams({
        name: userData.name,
        age: userData.age,
        gender: userData.gender,
        weight: userData.weight,
        height: userData.height,
        ic: userData.ic
      }).toString();
      window.location.href = `index.html?${query}`;
    });
  </script>
</body>
</html>
